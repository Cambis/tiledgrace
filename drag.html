<!DOCTYPE html>
<html>
 <head>
     <meta charset="UTF-8">
     <title>Gratch</title>
     <link rel="stylesheet" type="text/css" href="style.css">
 </head>
 <body>
     <div id="codearea">
         <div id="bin"></div>
     </div>
     <div id="toolbox">
         <div class="tile vardec"><span style="margin-right: 4px; color: blue;">var</span><input type="text" value="" size="1" class="variable-name"><span style="margin-left: 4px; margin-right: 4px; color: #687687;">:=</span><div class="hole"></div></div>
         <div class="tile var"><select name="var"></select></div>
         <div class="tile assign"><div class="hole"></div><span style="margin-left: 4px; margin-right: 4px; color: #687687;">:=</span><div class="hole"></div></div>
         <div class="tile operator"><div class="hole number"></div><div class="op">+</div><div class="hole number"></div></div>
         <div class="tile comparison-operator"><div class="hole number"></div><div class="cmpop">==</div><div class="hole number"></div></div>
         <div class="tile number"><input type="text" value="0" size="3" ></div>
         <div class="tile string">"<input type="text" value="Hello, world!" size="13" >"</div>
         <div class="tile request"><div class="hole"></div><span>.</span><input type="text" size="5"></div>
         <div class="tile if"><div><span>if (</span><div class="hole"></div><span>) then {</span></div><div style="padding-left: 2ex;"><div class="hole multi"></div></div><div><span style="display:inline;">}</span></div></div>
         <div class="tile if else if-else"><div><span>if (</span><div class="hole"></div><span>) then {</span></div><div style="padding-left: 2ex;"><div class="hole multi"></div></div><div><span style="display:inline;">} else {</span></div><div style="padding-left: 2ex;"><div class="hole multi"></div></div><div><span>}</span></div></div>
         <div class="tile while"><div><span>while {</span><div class="hole"></div><span>} do {</span></div><div style="padding-left: 2ex;"><div class="hole multi"></div></div><div><span style="display:inline;">}</span></div></div>
         <div class="tile print"><span style="margin-right: 4px;">print </span><div class="hole"></div></div>
     </div>
     <textarea id="gracecode"></textarea><br />
     <textarea id="stdout_txt" style="clear:both;" cols="100" rows="5"></textarea><input type="button" onclick="go()" value="Run"><input type="button" onclick="generateJSON()" value="Save">
     <br /><textarea id="stderr_txt" style="clear:both;" cols="100" rows="5"></textarea>
     <script type="text/javascript" src="main.js"></script>
     <script type="text/javascript" src="json.js"></script>
     <script type="text/javascript" src="minigrace.js"></script>
     <script type="text/javascript">
        var getCode = function() {
            return document.getElementById('gracecode').value;
        }

        // Setup stderr.
        minigrace.stderr_write = function(value) {
            var stderr = document.getElementById("stderr_txt");
            stderr.value += value;
            stderr.scrollTop = stderr.scrollHeight;
        };

        // Setup stdout.
        minigrace.stdout_write = function(value) {
            var stdout = document.getElementById("stdout_txt");
            stdout.value += value;
            stdout.scrollTop = stdout.scrollHeight;
        };

        function go() {
            document.getElementById('stderr_txt').value = "";
            document.getElementById('stdout_txt').value = "";
            minigrace.modname = "main";
            minigrace.compilerun(getCode());
        }
        if (localStorage.getItem("autosave-json")) {
            loadJSON(localStorage.getItem("autosave-json"));
        }
    </script>
 </body>
</html>
